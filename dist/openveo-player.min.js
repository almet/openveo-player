/* openveo-player v1.0.1 */
"use strict";!function(a){var b=a.module("ov.player",[]);if("undefined"==typeof ovPlayerDirectory||"string"!=typeof ovPlayerDirectory)throw new Error("ovPlayerDirectory global variable must be defined and set to the root path of the openVeo player");b.constant("i18nTranslations",{en:{VIDEO_TAB_TITLE:"Video",INDEX_TAB_TITLE:"Index",CHAPTERS_TAB_TITLE:"Chapters",LOADING:"Loading..."},fr:{VIDEO_TAB_TITLE:"VidÃ©o",INDEX_TAB_TITLE:"Index",CHAPTERS_TAB_TITLE:"Chapitres",LOADING:"Chargement..."}})}(angular),function(a){function b(a){return{require:["^ovPlayer","^ovTabs"],restrict:"E",templateUrl:ovPlayerDirectory+"templates/chapters.html",scope:!0,link:a}}a.factory("ovChaptersLink",function(){return function(a,b,c,d){a.open=function(b){b.description&&""!=b.description&&(b.isOpen||angular.forEach(a.chapters,function(a){a.isOpen=!1}),b.isOpen=!b.isOpen)},a.goToTimecode=function(b){var c=d[0],e=d[1];1>=b&&c.setTime(b*a.duration),e.selectTabs("media")}}}),a.directive("ovChapters",b),b.$inject=["ovChaptersLink"]}(angular.module("ov.player")),function(a){function b(a){return{require:["^ovPlayer","^ovTabs"],restrict:"E",templateUrl:ovPlayerDirectory+"templates/index.html",scope:!0,link:a}}a.factory("ovIndexLink",function(){return function(a,b,c,d){a.timecodes.length&&(a.imagePreview=a.timecodes[0].image.large),a.setImagePreview=function(b){a.imagePreview=a.timecodesByTime[b].image.large},a.goToTimecode=function(b){var c=d[0],e=d[1];b<=a.duration&&c.setTime(b),e.selectTabs("media")}}}),a.directive("ovIndex",b),b.$inject=["ovIndexLink"]}(angular.module("ov.player")),function(a){function b(){function a(){}return a.prototype.init=function(a,b){if(!a||!b)throw new Error("A player JQLite Element and a media object are expected as Player arguments");this.jPlayerElement=a,this.media=b,this.playerId="player_"+this.media.mediaId},a.prototype.getMediaId=function(){return this.media.mediaId},a.prototype.getId=function(){return this.playerId},a.prototype.getMediaUrl=function(){throw new Error("getMediaUrl method not implemented for this player")},a.prototype.getMediaThumbnail=function(){throw new Error("getMediaThumbnail method not implemented for this player")},a.prototype.initialize=function(){throw new Error("initialize method not implemented for this player")},a.prototype.playPause=function(){throw new Error("play method not implemented for this player")},a.prototype.setVolume=function(){throw new Error("setVolume method not implemented for this player")},a.prototype.setTime=function(){throw new Error("setTime method not implemented for this player")},a.prototype.getPlayerType=function(){throw new Error("getPlayerType method not implemented for this player")},a.prototype.destroy=function(){throw new Error("destroy method not implemented for this player")},a}a.factory("OvPlayer",b)}(angular.module("ov.player")),function(a,b){function c(b,c,e,f,g,h,i){return{restrict:"E",templateUrl:ovPlayerDirectory+"templates/player.html",scope:{ovData:"=",ovFullscreenIcon:"=?",ovVolumeIcon:"=?",ovModeIcon:"=?",ovTime:"=?",ovFullViewport:"=?",ovLanguage:"=?",ovPlayerType:"@?"},controller:["$scope","$element",function(f,j){function k(){return G.requestFullScreen||G.mozRequestFullScreen||G.webkitRequestFullScreen||G.msRequestFullscreen}function l(){return 1==("ontouchstart"in window||window.DocumentTouch&&E instanceof DocumentTouch)}function m(a){g(function(){var b=f.$root.$$phase;"$apply"===b||"$digest"===b?a():f.$apply(a)},1)}function n(a){if(f.timecodes.length){for(var b=0;b<f.timecodes.length;b++)if(a>f.timecodes[b].timecode&&f.timecodes[b+1]&&a<f.timecodes[b+1].timecode)return f.timecodes[b].timecode;return f.timecodes[f.timecodes.length-1].timecode}return 0}function o(a){m(function(){f.volumePreview=Math.round((J.bottom-a.pageY)/K*100)})}function p(){c.off("mousemove",o),a.element(I).off("mouseout",p),m(function(){f.volumePreview=0})}function q(a){var b=n((a.pageX-L.left)/M*f.duration);m(function(){f.timecodesByTime[b]&&(f.timePreview=f.timecodesByTime[b].image.large),f.timePreviewPosition=(a.pageX-L.left)/M*100})}function r(){c.off("mousemove",q),a.element(H).off("mouseout",r),m(function(){f.timePreviewPosition=0,f.timePreviewOpened=!1})}function s(){f.displayIndexTab=!1,f.selectedMode=d[0],f.ovModeIcon=!1}function t(){f.displayIndexTab=!0,f.selectedMode=d[1],f.ovModeIcon=!0}function u(){f.displayChapterTab=!1}function v(){f.displayChapterTab=!0}function w(){f.chapters=h.getMediaChapters()||[],f.chapters.length?(f.displayChapterTab=f.chapters.length,v()):u()}function x(){f.timecodes=h.getMediaTimecodes()||[],f.timecodesByTime=h.getMediaTimecodesByTime()||{},f.timecodes.length?(f.timePreview=f.presentation=f.timecodes[0].image.large,t()):s()}function y(){if(f.data.mediaId){var a=f.ovPlayerType||f.data.type||"html";switch(f.mediaTemplate=ovPlayerDirectory+"templates/"+a+".html",a.toLowerCase()){case"vimeo":var c=b.get("OvVimeoPlayer");f.player=new c(j,f.data);break;case"html":var d=b.get("OvHTMLPlayer");f.player=new d(j,f.data);break;case"flowplayer":var e=b.get("OvFlowPlayer");f.player=new e(j,f.data);break;default:throw new Error("Player "+a+" is not supported")}}}function z(){f.data=a.copy(f.ovData)||{},h.setMedia(f.data),y(),f.player&&(f.isCut=f.data.cut&&f.data.cut.length,f.timecodes=[],f.timecodesByTime={},f.chapters=[],f.presentation=null,f.playerId=f.player.getId(),f.timePreviewOpened=!1,f.volumeOpened=!1,f.modesOpened=!1,f.modes=a.copy(d),f.selectedMode=d[1],f.playPauseButton="play",f.fullscreenButton="enlarge",f.volumePreview=0,f.volume=100,f.loadedStart=0,f.loadedPercent=0,f.seenPercent=0,f.time=0,f.duration=0,f.timePreviewPosition=0,f.displayIndexTab=!0,f.displayChapterTab=!0,f.mediaUrl=e.trustAsResourceUrl(f.player.getMediaUrl()),f.mediaThumbnail=f.player.getMediaThumbnail(),f.loading=!0,i.setLanguage(f.ovLanguage),f.ovFullViewport&&!k()&&(f.fullscreenButton="reduce",D=!0),l()&&(f.ovVolumeIcon=!1),f.isCut?(f.displayChapterTab=!1,s(),u()):(x(),w()))}var A,B,C=this,D=!1,E=c[0],F=j[0],G=j.children()[0],H=F.getElementsByClassName("ov-time-ghost")[0],I=F.getElementsByClassName("ov-volume-ghost")[0],J=I.getBoundingClientRect(),K=J.bottom-J.top,L=H.getBoundingClientRect(),M=L.right-L.left;f.player=null,f.ovFullscreenIcon="undefined"==typeof f.ovFullscreenIcon?!0:f.ovFullscreenIcon,f.ovVolumeIcon="undefined"==typeof f.ovVolumeIcon?!0:f.ovVolumeIcon,f.ovModeIcon="undefined"==typeof f.ovModeIcon?!0:f.ovModeIcon,f.ovTime="undefined"==typeof f.ovTime?!0:f.ovTime,f.ovFullViewport="undefined"==typeof f.ovFullViewport?!1:f.ovFullViewport,f.ovLanguage="undefined"==typeof f.ovLanguage?"en":f.ovLanguage,z(),f.toggleModes=function(){A&&g.cancel(A),f.volumeOpened=!1,f.modesOpened=!f.modesOpened,f.modesOpened&&(A=g(function(){f.modesOpened=!1},3e3))},f.toggleVolume=function(){B&&g.cancel(B),f.modesOpened=!1,f.volumeOpened=!f.volumeOpened,f.volumeOpened&&(B=g(function(){f.volumeOpened=!1},3e3))},f.toggleFullscreen=function(){G.requestFullScreen||G.mozRequestFullScreen||G.webkitRequestFullScreen||G.msRequestFullscreen?"undefined"!==E.fullScreenElement&&null===E.fullScreenElement||"undefined"!==E.msFullscreenElement&&null===E.msFullscreenElement||"undefined"!==E.mozFullScreen&&E.mozFullScreen===!1||"undefined"!==E.webkitFullscreenElement&&null===E.webkitFullscreenElement?(G.requestFullScreen?G.requestFullScreen():G.mozRequestFullScreen?G.mozRequestFullScreen():G.webkitRequestFullScreen?G.webkitRequestFullScreen():G.msRequestFullscreen&&G.msRequestFullscreen(),f.fullscreenButton="reduce"):(E.exitFullscreen?E.exitFullscreen():E.mozCancelFullScreen?E.mozCancelFullScreen():E.webkitExitFullscreen?E.webkitExitFullscreen():E.msExitFullscreen&&E.msExitFullscreen(),f.fullscreenButton="enlarge"):(D=f.ovFullViewport=!D,f.fullscreenButton=D?"reduce":"enlarge")},f.$on("$includeContentLoaded",function(){g(function(){f.player.initialize()},1)}),f.$watch("ovData",function(){f.data=a.copy(f.ovData)||{},!f.data.mediaId||f.player&&f.data.mediaId==f.player.getMediaId()||(f.player&&f.player.destroy(),z())}),f.$watch("ovModeIcon",function(){f.timecodes&&!f.timecodes.length&&f.ovModeIcon&&(f.ovModeIcon=!1)}),f.$watch("ovVolumeIcon",function(){l()&&(f.ovVolumeIcon=!1)}),f.setVolume=function(a){var b=Math.min(Math.round((J.bottom-a.pageY)/K*100),100);C.setVolume(b)},f.setTime=function(a){C.setTime((a.pageX-L.left)/M*f.duration)},this.selectMode=f.selectMode=function(a){f.selectedMode=a},this.playPause=f.playPause=function(){f.loading||f.player.playPause()},this.setVolume=function(a){f.volume=a,f.player.setVolume(f.volume)},this.setTime=function(a){f.player.setTime(h.getRealTime(a))},a.element(I).on("mouseover",function(){J=I.getBoundingClientRect(),K=J.bottom-J.top,c.on("mousemove",o),a.element(I).on("mouseout",p)}),a.element(H).on("mouseover",function(b){f.timecodes&&f.timecodes.length&&(L=H.getBoundingClientRect(),M=L.right-L.left,q(b),c.on("mousemove",q),a.element(H).on("mouseout",r),m(function(){f.timePreviewOpened=!0}))}),j.on("ready",function(){m(function(){f.player.setVolume(100),f.loading=!1})}),j.on("waiting",function(){m(function(){f.loading=!0})}),j.on("playing",function(){m(function(){f.loading=!1,f.playPauseButton="pause"})}),j.on("durationChange",function(a,b){m(function(){h.setRealMediaDuration(b),f.duration=h.getCutDuration(),f.isCut&&(x(),w(),f.player.setTime(h.getRealTime(0)))})}),j.on("play",function(){m(function(){f.loading=!1,f.playPauseButton="pause"})}),j.on("pause",function(){m(function(){f.playPauseButton="play"})}),j.on("loadProgress",function(a,b){m(function(){f.loadedStart=h.getCutPercent(b.loadedStart),f.loadedPercent=h.getCutPercent(b.loadedPercent)})}),j.on("playProgress",function(a,b){f.loading=!1;var c=n(b.time),d=function(){f.time=h.getCutTime(b.time),f.seenPercent=h.getCutPercent(b.percent),f.timecodesByTime[c]&&(f.presentation=f.timecodesByTime[c].image.large)};h.getCutTime(b.time)>h.getCutDuration()?(f.player.setTime(h.getRealTime(0)),f.player.playPause()):m(d)}),j.on("end",function(){m(function(){f.time=f.seenPercent=0,f.playPauseButton="play",f.timecodes.length&&(f.presentation=f.timecodes[0].image.large),f.isCut&&f.player.setTime(h.getRealTime(0))})})}]}}var d=["media","both","both-presentation","presentation"];b.directive("ovPlayer",c),c.$inject=["$injector","$document","$sce","$filter","$timeout","playerService","i18nPlayerService"]}(angular,angular.module("ov.player")),function(a){function b(){function a(){return o&&m?o*m:0}function b(){return o?n?o*n:o:0}function c(b){return b+a()}function d(b){return Math.max(b-a(),0)}function e(a){if(l=a,p=l.cut&&l.cut.length){for(var b=0;b<l.cut.length;b++)"begin"===l.cut[b].type?m=Math.max(l.cut[b].value,0):"end"===l.cut[b].type&&(n=Math.min(l.cut[b].value,1));m===n&&(m=0,n=null)}else m=0,n=null}function f(){if(p&&o&&l.timecodes){for(var c=[],d=a(),e=b(),f=0;f<l.timecodes.length;f++){var g=l.timecodes[f].timecode;g>=d&&e>=g&&c.push(l.timecodes[f])}return c}return l.timecodes}function g(){var a={},b=f();if(b)for(var c=0;c<b.length;c++){var d=b[c];a[d.timecode]={image:{small:d.image.small,large:d.image.large}}}return a}function h(){if(p&&o&&l.chapters){for(var c=[],d=a(),e=b(),f=0;f<l.chapters.length;f++){var g=o*l.chapters[f].value;g>=d&&e>=g&&c.push(l.chapters[f])}return c}return l.chapters}function i(){if(o){var c=b(),d=a();return c-d}return 0}function j(b){if(o){var c=o*(b/100);return Math.min(Math.max((c-a())/i()*100,0),100)}return b}function k(a){o=a}var l=null,m=0,n=null,o=null,p=!1;return{setMedia:e,setRealMediaDuration:k,getMediaTimecodes:f,getMediaTimecodesByTime:g,getMediaChapters:h,getCutDuration:i,getRealTime:c,getRealCutStart:a,getRealCutEnd:b,getCutPercent:j,getCutTime:d}}a.factory("playerService",b),b.$inject=[]}(angular.module("ov.player")),function(a){function b(){return{restrict:"E",templateUrl:ovPlayerDirectory+"templates/tabs.html",scope:{},transclude:!0,controller:["$scope","$filter",function(a,b){a.views=[],a.select=function(b){angular.forEach(a.views,function(a){a.selected=!1}),b.selected=!0},this.selectTabs=function(c){var d=b("filter")(a.views,{viewId:c},!0);0!=d.length&&a.select(d[0])},this.addView=function(b){a.views.length||a.select(b),a.views.push(b)}}]}}a.directive("ovTabs",b)}(angular.module("ov.player")),function(a){function b(){return function(a){if(0>a||isNaN(a))return"";a=parseInt(a);var b=parseInt(a/1e3%60),c=parseInt(a/6e4%60),d=parseInt(a/36e5%24);return d=10>d?"0"+d:d,c=10>c?"0"+c:c,b=10>b?"0"+b:b,("00"!==d?d+":":"")+c+":"+b}}a.filter("millisecondsToTime",b)}(angular.module("ov.player")),function(a){function b(a){return{restrict:"E",require:"^ovTabs",transclude:!0,templateUrl:ovPlayerDirectory+"templates/view.html",scope:{title:"@",view:"@",viewId:"@"},link:a}}a.factory("ovViewLink",function(){return function(a,b,c,d){d.addView(a)}}),a.directive("ovView",b),b.$inject=["ovViewLink"]}(angular.module("ov.player")),function(a){function b(a){return function(b){return a.translate(b)}}a.filter("ovTranslate",b),b.$inject=["i18nPlayerService"]}(angular.module("ov.player")),function(a,b){function c(a){function b(b){return Object.keys(a).indexOf(b)>=0}function c(a){f=b(a)?a:"en"}function d(){return f}function e(b){var c=a[f]&&a[f][b]||b;return c===b&&(c=a.en[b]||b),c}var f=navigator.language||navigator.browserLanguage;return{translate:e,isLanguageSupported:b,setLanguage:c,getLanguage:d}}b.service("i18nPlayerService",c),c.$inject=["i18nTranslations"]}(angular,angular.module("ov.player")),function(a,b){function c(b,c,d,e){function f(a){switch(a.type){case"ready":var b=this.player.video.duration||this.media.metadata&&this.media.metadata.duration;this.loaded=!0,this.playing=0,this.jPlayerElement.triggerHandler("durationChange",1e3*b),this.jPlayerElement.triggerHandler("ready");break;case"resume":case"play":this.playing=1,this.jPlayerElement.triggerHandler("play");break;case"pause":this.playing=0,this.jPlayerElement.triggerHandler("pause");break;case"finish":this.playing=0,this.jPlayerElement.triggerHandler("end");break;case"progress":this.jPlayerElement.triggerHandler("loadProgress",{loadedStart:0,loadedPercent:this.player.video.buffer/this.player.video.duration*100});var c=this.player.video.time/this.player.video.duration*100;this.jPlayerElement.triggerHandler("playProgress",{time:1e3*this.player.video.time,percent:c})}}function g(a,c){if(b.prototype.init.call(this,a,c),"undefined"==typeof ovFlashPlayer||"string"!=typeof ovFlashPlayer)throw new Error("ovFlashPlayer global variable must be defined and set to the flowplayer.swf file")}var h=["finish","pause","progress","ready","resume"];return g.prototype=new b,g.prototype.constructor=g,g.prototype.getMediaUrl=function(){return this.media.files[0].link},g.prototype.getMediaThumbnail=function(){return this.media.thumbnail},g.prototype.initialize=function(){this.loaded=!1,this.jPlayerElement.triggerHandler("waiting");var b=d[0].getElementById(this.playerId);this.player=flowplayer(b,{swf:ovFlashPlayer,clip:{sources:[{type:"video/mp4",src:this.getMediaUrl()}]}}),this.handlePlayerEventsFn=a.bind(this,f);for(var c=0;c<h.length;c++)this.player.on(h[c],this.handlePlayerEventsFn)},g.prototype.playPause=function(){this.playing?this.player.pause():this.player.resume()},g.prototype.setVolume=function(a){this.player.volume(a/100)},g.prototype.setTime=function(a){var b=this;a=parseInt(a)||.1,this.player.pause(),e(function(){b.jPlayerElement.triggerHandler("waiting"),b.player.seek(a/1e3,function(){b.player.resume()})},1)},g.prototype.getPlayerType=function(){return"flowplayer"},g.prototype.destroy=function(){this.handlePlayerEventsFn=a.bind(this,f);for(var b=a.element(this.player),c=0;c<h.length;c++)b.off(h[c],this.handlePlayerEventsFn);this.loaded=!1,this.playing=0,this.player=null},g}b.factory("OvFlowPlayer",c),c.$inject=["OvPlayer","$window","$document","$timeout"]}(angular,angular.module("ov.player")),function(a,b){function c(b,c,d){function e(a){switch(a.type){case"progress":if(1===this.player.buffered.length){var b=this.player.buffered.start(0)/this.player.duration,c=this.player.buffered.end(0)/this.player.duration;this.jPlayerElement.triggerHandler("loadProgress",{loadedStart:100*Math.max(0,Math.min(b,1)),loadedPercent:100*Math.max(0,Math.min(c-b,1))})}break;case"durationchange":var d=this.player.duration||this.media.metadata&&this.media.metadata.duration;this.jPlayerElement.triggerHandler("durationChange",1e3*d);break;case"loadeddata":this.loaded=!0,this.jPlayerElement.triggerHandler("ready");break;case"play":this.jPlayerElement.triggerHandler("play");break;case"pause":this.jPlayerElement.triggerHandler("pause");break;case"ended":this.jPlayerElement.triggerHandler("end");break;case"waiting":this.jPlayerElement.triggerHandler("waiting");break;case"playing":this.jPlayerElement.triggerHandler("playing");break;case"timeupdate":var e=this.player.currentTime/this.player.duration*100;this.jPlayerElement.triggerHandler("playProgress",{time:1e3*this.player.currentTime,percent:e})}}function f(a,c){b.prototype.init.call(this,a,c)}var g=["loadeddata","progress","playing","waiting","ended","durationchange","timeupdate","play","pause"];return f.prototype=new b,f.prototype.constructor=f,f.prototype.getMediaUrl=function(){return this.media.files[0].link},f.prototype.getMediaThumbnail=function(){return this.media.thumbnail},f.prototype.initialize=function(){this.loaded=!1,this.player=d[0].getElementById(this.playerId),this.handlePlayerEventsFn=a.bind(this,e);for(var b=a.element(this.player),c=0;c<g.length;c++)b.on(g[c],this.handlePlayerEventsFn);this.player.load()},f.prototype.playPause=function(){this.player.paused||this.player.ended?this.player.play():this.player.pause()},f.prototype.setVolume=function(a){this.player.volume=a/100},f.prototype.setTime=function(a){a=parseInt(a)||.1,this.player.currentTime=a/1e3},f.prototype.getPlayerType=function(){return"html"},f.prototype.destroy=function(){this.handlePlayerEventsFn=a.bind(this,e);for(var b=a.element(this.player),c=0;c<g.length;c++)b.off(g[c],this.handlePlayerEventsFn);this.loaded=!1,this.player=null},f}b.factory("OvHTMLPlayer",c),c.$inject=["OvPlayer","$window","$document"]}(angular,angular.module("ov.player")),function(a,b){function c(b,c,d){function e(a,b){if(this.loaded){var c={method:a};return b&&(c.value=b),this.player.contentWindow.postMessage(JSON.stringify(c),this.postMessageTargetOrigin)}return null}function f(){this.postMessageTargetOrigin="https:"+this.getMediaUrl().split("?")[0],this.player=d[0].getElementById(this.playerId),this.loaded=!0,this.playing=0,e.call(this,"addEventListener","loadProgress"),e.call(this,"addEventListener","playProgress"),e.call(this,"addEventListener","play"),e.call(this,"addEventListener","pause"),e.call(this,"addEventListener","finish")}function g(a,b){if(b=a.data?JSON.parse(a.data):b,b.player_id===this.playerId){switch(b.event){case"ready":f.call(this),e.call(this,"getDuration"),this.jPlayerElement.triggerHandler("ready");break;case"loadProgress":this.jPlayerElement.triggerHandler("loadProgress",{loadedStart:0,loadedPercent:100*b.data.percent});break;case"playProgress":b.data.percent<=1&&this.jPlayerElement.triggerHandler("playProgress",{time:1e3*b.data.seconds,percent:100*b.data.percent});break;case"play":this.playing=1,this.jPlayerElement.triggerHandler("play");break;case"pause":this.playing=0,this.jPlayerElement.triggerHandler("pause");break;case"finish":this.playing=0,this.jPlayerElement.triggerHandler("end")}switch(b.method){case"getDuration":this.duration=b.value||this.media.metadata&&this.media.metadata.duration,this.jPlayerElement.triggerHandler("durationChange",1e3*this.duration);break;default:return}}}function h(){this.loaded=!1,this.handlePlayerEventsFn=a.bind(this,g),a.element(c).on("message",this.handlePlayerEventsFn)}function i(a,c){b.prototype.init.call(this,a,c),h.call(this)}return i.prototype=new b,i.prototype.constructor=i,i.prototype.getMediaUrl=function(){return"//player.vimeo.com/video/"+this.media.mediaId+"?api=1&player_id="+this.playerId},i.prototype.getMediaThumbnail=function(){return null},i.prototype.initialize=function(){},i.prototype.playPause=function(){e.call(this,this.playing?"pause":"play")},i.prototype.setVolume=function(a){e.call(this,"setVolume",a/100)},i.prototype.setTime=function(a){a=parseInt(a)||.1,e.call(this,"seekTo",a/1e3),this.playing||this.jPlayerElement.triggerHandler("playProgress",{time:a,percent:a/this.duration*100})},i.prototype.getPlayerType=function(){return"vimeo"},i.prototype.destroy=function(){a.element(c).off("message",this.handlePlayerEventsFn),this.loaded=!1,this.playing=0,this.player=null},i}b.factory("OvVimeoPlayer",c),c.$inject=["OvPlayer","$window","$document"]}(angular,angular.module("ov.player"));